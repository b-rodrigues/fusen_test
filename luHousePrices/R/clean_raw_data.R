# WARNING - Generated by {fusen} from /minimal/save_data.qmd: do not edit by hand

#' clean_raw_data Cleans the raw data
#'
#' @param url Optional: Persistent url to the data
#' @details Removes uneeded rows, renames localities to make their names consistent across years and converts columns with prices to numeric columns
#' @return A data frame
#' @export
clean_raw_data <- function(raw_data){
  raw_data %>%
    mutate(locality = ifelse(grepl("Luxembourg-Ville", locality),
                             "Luxembourg",
                             locality),
           locality = ifelse(grepl("P.tange", locality),
                             "PÃ©tange",
                             locality)
           ) %>%
    filter(!grepl("Source", locality)) %>%
    mutate(across(starts_with("average"), as.numeric))
}
